<!-- Affichage des messages -->
<p-toast></p-toast>

<!-- ðŸ”˜ Action buttons -->
<div class="card mb-3">
  <div class="flex flex-wrap gap-3">
    <p-button label="Encode Patient" icon="pi pi-pencil" iconPos="right" [outlined]="true" (click)="importEncode=true"></p-button>
    <p-button label="Import Excel/CSV" icon="pi pi-file-excel" iconPos="right" severity="success" [outlined]="true" (click)="importExcel=true"></p-button>
    <p-button label="Import PDF/Image" icon="pi pi-file-pdf" iconPos="right" severity="danger" [outlined]="true" (click)="importPDF=true"></p-button>
    <p-button label="Scan Document" icon="pi pi-camera" iconPos="right" severity="warning" [outlined]="true"></p-button>
  </div>

  <div class="mt-3">
    <span class="text-600 font-medium line-height-3">Need help?</span>
    <a class="font-medium no-underline ml-2 text-blue-500 cursor-pointer" routerLink="faq">Go to FAQ!</a>
  </div>
</div>

<!-- Enhanced search zone -->
<div class="card mb-3">
  <div class="flex flex-column md:flex-row gap-3 align-items-center justify-content-between">

    <!-- Search input with larger styling -->
    <div class="flex-grow-1 w-full md:w-7">
      <input
        type="text"
        pInputText
        class="w-full p-inputtext-lg"
        style="padding: 1rem; font-size: 1.1rem; border-radius: 8px;"
        placeholder="Search by name, surname, email..."
        [(ngModel)]="searchText"
        (keydown.enter)="onSearch()" />
    </div>

    <!-- Buttons -->
    <div class="flex gap-2 justify-content-end w-full md:w-auto">
      <button
        pButton
        label="Search"
        icon="pi pi-search"
        class="p-button-primary"
        (click)="onSearch()">
      </button>

      <button
        pButton
        label="Reset"
        icon="pi pi-times"
        class="p-button-secondary"
        (click)="resetSearch()">
      </button>

      <button
        pButton
        label="Show All"
        icon="pi pi-list"
        class="p-button-success"
        (click)="showAllPatients()">
      </button>
    </div>

  </div>
</div>


<!-- Tableau des patients -->
<div class="card">
  <p-table
    [value]="patients"
    [paginator]="true"
    [rows]="rows"
    [totalRecords]="totalRecords"
    [loading]="loadingPatients"
    [lazy]="true"
    [first]="first"
    (onLazyLoad)="pageChange($event)"
    dataKey="id"
    [rowsPerPageOptions]="[10, 25, 50]"
    [(selection)]="selectedPatient"
    (onRowSelect)="selectPatient(selectedPatient.id)"
    [responsiveLayout]="'scroll'"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} patients"
    [style]="{ 'min-width': '60rem' }">

    <!-- En-tÃªte -->
    <ng-template pTemplate="header">
      <tr>
        <th style="width: 4rem"></th>
        <th>Lastname</th>
        <th>Firstname</th>
        <th>Birthdate</th>
      </tr>
    </ng-template>

    <!-- Corps -->
    <ng-template pTemplate="body" let-patient>
      <tr>
        <td>
          <p-tableRadioButton [value]="patient"></p-tableRadioButton>
        </td>
        <td>{{ patient.lastname }}</td>
        <td>{{ patient.firstname }}</td>
        <td>{{ patient.birthDate }}</td>
      </tr>
    </ng-template>

    <!-- Message si vide -->
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4" class="text-center">No patient found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>

<!-- Modales d'import -->
<dialog-import-excel-display [visible]="importExcel" (visibleModified)="hideImportExcel($event)"></dialog-import-excel-display>
<dialog-import-pdf-display [visible]="importPDF" (visibleModified)="hideImportPDF($event)"></dialog-import-pdf-display>
<dialog-import-encode-display [visible]="importEncode" (visibleModified)="hideImportEncode($event)"></dialog-import-encode-display>
